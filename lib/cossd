#! /usr/bin/env node
console.log('Starting Node');
console.log('Setting Node timer');
let i = 0;
setInterval(() => {
    console.log('Node is alive', ++i);
}, 1000);
const coss = require('bindings')('coss.node');
console.log('Have COSS', coss);

const instance = coss.start((instance, str) => {
    console.error('received dispatch from Go', instance, str);
    coss.syscall(instance, "Hello from Go dispatch: " + str.toUpperCase());
}, process.argv.slice(1));

console.log('Got from COSS', coss.syscall(instance, "Hello from node proper!"));
